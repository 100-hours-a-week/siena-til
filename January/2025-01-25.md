
## 📅 날짜: 2025-01-25 ~ 01-26


### 💬 학습 목표

- 학습 목표 1 : K8s Node 관리 이해하기
- 학습 목표 2 : K8s Pod 관리 이해하기


### 📒 오늘 공부한 내용
#### | [K8s Node 관리] Taint와 Tolerations

**Taint/Tolerations**는 **특정 노드에 Pod가 오도록/오지 않도록 오염(taint) 기반 제어**를 말합니다.

1. 개요

- 어원
    - Taint: 오염시키다, 더렵히다
        
        K8s에서 Taint는 노드에 특정 오염조건을 부여하여 노드에 파드가 스케줄링되지 않도록 만드는 장치입니다.
        
    - Toleration: 용인하다, 허용하다
        
        K8s에서 Toleration은 Taint된 노드에 스케줄링될 수 있게 하는 허용조건입니다.

2. 동작 원리

    1. 사용자: `kubectl apply` 로 파드 생성 <br/>
    2. K8s 마스터 노드: scheduler가 파드를 어느 노드에 스케줄링할지 결정하려함 <br/>
        => 이때 node A 에 taint가 걸렸는지 확인 <br/>

        1. 파드가 toleration을 가지고 있음 <br/>
            toleration이 taint를 허용하여 Node A로 스케줄링 가능
        
        2. 파드가 toleration이 없음 <br/>
            taint에 따라 Node A로 스케줄링 할 수 없으므로 Node B의 taint를 확인 후 스케줄링

3. 특징
    - Taint와 Toleration을 함께 사용하면 특정 노드에만 배포되도록 하거나 반대로 특정 노드로는 절대 가지 못하게 하는 등의 세밀한 제어가 가능합니다.

4. 사용
    1. **전용 리소스 노드**
    
        GPU나 고성능 SSD를 가진 노드에 특정 파드만 배포하고 싶을 때
    
        ex) GPU 노드는 `gpu=true:NoSchedule` 같은 taint를 달고,
        GPU가 필요한 파드에는 toleration을 추가하여 배포
    
    2. **테스트/개발 구분**
    
        특정 노드는 QA용도이고, 다른 노드는 프로덕션 용도인 경우
    
        ex) `env=dev:NoSchedule` taint를 통해 해당 노드에는 dev 파드만 가도록 설정
    
    3. **보안 및 정책 수준**
    
        민감데이터 처리를 위해 보안이 강화된 노드로만 제한적으로 파드를 배포하고 싶을 때

#### | [K8s Pod 관리] PodLabel

쿠버네티스 객체에 태그를 부착하여 식별, 필터링, 그룹화를 하는 데 사용합니다.

1. 개념

    - K8s에서는 Pod, Service, ReplicaSet 등 **거의 모든 오브젝트에 Key=Value 형태로 레이블을 붙일 수 있습니다.**
    - 이 레이블을 활용하여 원하는 Pod만 모아서 조회하거나 Pod그룹에서 Service를 연결하는 등 작업을 수행할 수 있습니다.

2. 동작

    1. 개발자: `kubectl apply -f pod.yaml` 명령어로 라벨이 포함된 Pod 생성
    
    ```yaml
    labels:
        app: siena-ex
        version: v1
    ```
    
    2. 마스터 노드: 스케줄링
    3. 워커노드: Pod를 생성 및 실행
    4. 개발자: `kubectl get pods -l app=siena-ex` 명령어로 특정 라벨이 달린 파드 조회
    - 마스터 노드가 라벨의 내용에 영향을 받지는 않지만, 파드가 어떤 역할/그룹에 속하는지 추적할 때 레이블이 크게 활용됨

3. 특징

    1. **Key=Value 형식**
        - ex) `app=nginx`, `environment=production`, `release=1.0`
    2. **하나의 오브젝트에 여러 레이블 가능**
    3. **Selector와 연동**
    4. **immutable 아님 (수정가능)**
    5. **주로 사용되는 목적**
        - 파드 검색/조회 `kubectl get pods -l app=nginx`
        - 리소스 그룹화 (같은 라벨을 달아 ‘어플리케이션 1팀 소유’ 식으로 구분)
        - CI/CD 파이프라인에서 버전관리 (버전에 따른 레이블 변경)

4. 사용

    1. **대규모 어플리케이션을 모니터링 할 때**
    
    라벨을 이용해 특정 서비스 그룹, 릴리즈 버전, 팀단위 등으로 쉽게 파드를 필터링할 수 있다.
    
    2. **운영환경과 개발환경을 구분할 때**
        
        `env=prod`, `env=dev` 같은 라벨로 어느 파드가 어떤 환경인지 구분할 수 있다.
        
    3. **긴급 장애 발생시**
        
        `team=backend`, `team=frontend` 레이블을 통해, 담당 팀 파드만 빠르게 조회한다.

#### | [K8s Pod 관리] Static Pod (정적 파드)

Static Pod는 **쿠버네티스 API 서버와 상관없이 특정 노트의 kubelet이 직접 읽고 실행하는 형태의 Pod입니다.** 


1. 개념

    - **쿠버네티스 API 서버와 상관없이** 특정 노드의 kubelet이 **직접 읽고 실행**하는 형태의 Pod입니다.
    - 보통 `/etc/kubernetes/manifests` 등의 특정 디렉터리에 놓인 YAML 파일을 `kubelet`이 주기적으로 스캔하여 관리합니다.
    - API 서버와 독립적으로 동작하기 때문에, API 서버에 의한 스케줄링 대신, **해당 노드에서 kubelet이 스스로 기동, 재시작, 삭제를 관리**합니다.

2. 동작

    1. 개발자: 정적파드 YAML 파일을 `/etc/kubernetes/manifests` 경로에 생성
    2. Node(Master or Worker): 정적 파드 생성됨
    3. `kubelet` : 지정된 디렉터리를 주기적으로 스캔
        1. Static Pod YAML 파싱 후 Pod 생성/관리
        2. Pod 상태 감시 및 필요시 재시작
        3. 업데이트가 있으면(YAML 파일 변경시) Pod를 재생성하여 업데이트 적용

⇒ Static Pod는 API Server와 직접적인 명령 연동 없이도 동작하나 Pod 상태정보는 API Server에 반영됩니다.

3. 특징

    1. API 서버를 거치지 않고 `kubelet` 이 직접 생성/관리한다.
    2. 노드마다 독립적인 YAML 파일을 둬야하므로, 노드별 셋팅이 필요하다.
    3. Pod 스케줄링 기능은 사용할 수 없다. (이미 노드가 정해져있음!)
    4. 관리 범위가 제한적이다.
        - `kubectl delete`로 삭제 불가 (삭제하더라도 즉시 재생성된다.)
        - `/etc/kubernetes/manifests`의 파일 자체를 지우거나 수정해야 한다.
    5. **Kubernetes Control Plane**(예: kube-apiserver, etcd, controller-manager 등)을 부팅 시점에 구동하기 위한 용도로 많이 사용된다.

4. 사용

    1. 클러스터의 핵심 컴포넌트(kube-apiserver, etcd 등) 쿠버네티스 자체를 구동하기 위해 API 서버보다 먼저 실행되어야하는 요소를 운영할 때
    2. 특정 노드에서 절대 꺼지면 안되는 혹은 API 서버와 관계없이 독립적으로 유지되어야하는 서비스를 구동할 때
    3. 여러 노드를 하나의 중앙 YAML로 관리하기보다는 각 노드별로 긴밀히 설정해둬야하는 경우에 사용

    => 아주 특이한 경우에만 사용된다. (굳이 안써도되는 느낌..)
    
### 🧑‍🧒‍🧒 팀 스터디 - 코딩테스트
#### | 매일 한 문제 이상 풀기!

1. 내가 푼 문제

- 8주차
    - (1/25) 백준 8958, 9506
    - (1/26) 백준 10162, 10103, 10214


### 🔥 도전 과제 달성 확인, 내일의 도전과제 설정
- (지난) 도전 과제 1: 1/17 쿠버네티스 강의 복습 마무리하기! ✅

- (내일) 도전 과제 1: 5주차 과제 시작하기

<br/>

### 💭 오늘의 회고 
- 성공적인 점: 드디어 쿠베 복습끝! <br/>
- 개선해야할 점: 1. 너무 오래걸렸다. 2. 실습을 못했다. <br/>

`과제하고 다시 실습해볼예정 🥹`

<br/>

### 📁 참고 자료 및 링크
