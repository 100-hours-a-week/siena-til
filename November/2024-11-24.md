## ğŸ“… ë‚ ì§œ: 2024-11-24


### ğŸ’¬ í•™ìŠµ ëª©í‘œ
- í•™ìŠµ ëª©í‘œ 1 : ì»¤ë®¤ë‹ˆí‹° ì •ì§„í•˜ê¸°


### ğŸ“’ ì˜¤ëŠ˜ ê³µë¶€í•œ ë‚´ìš©
#### | ì»¤ë®¤ë‹ˆí‹° ì§„í–‰ ìƒí™©

- user ê´€ë ¨ Routes, Controller, Model ì‘ì„± ì™„ë£Œ
- post ê´€ë ¨ Routes, Controller, Model ì‘ì„± ì¤‘
- comment API ê´€ë ¨ ì½”ë“œ ëŒ€ê¸°ì¤‘

#### | í”„ë¡ íŠ¸ì—”ë“œ - ë°±ì—”ë“œ ì—°ë™ ê³¼ì • ì •ë¦¬

ex) ê²Œì‹œê¸€ ì‘ì„± API
ìš”ì²­ POST /posts
ì‘ë‹µ
| ì‘ë‹µì½”ë“œ | ì‘ë‹µë©”ì‹œì§€ |
| --- | --- |
| 201 | { "message" : "post_created", "data" : {"postId" : 1} } |
| 400 | {"message" : "invalid_request","data" : null} |
| 401 | {"message" : "unauthorized_user","data" : null} |
| 500 | {"message" : "internal_server_error","data" : null} |

1. [be] server.js ì— post ê²½ë¡œ ì¶”ê°€
```javascript
const postRoutes = require('./routes/postRoutes')

app.use('/posts', postRoutes);
```

2. [be] postRoutes.js ì— postWrite ì—”ë“œí¬ì¸íŠ¸ ì„¤ì •
```javascript
router.post('/', requireAuth, postWrite);
```

3. [be] postModel.js ì‘ì„±
```javascript
const fs = require('fs').promises;
const path = require('path');

 const filePath = path.join(__dirname, '../data/posts.json');

// ëª¨ë“  ê²Œì‹œê¸€ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
const getAllPosts = async () => {
    const data = await fs.readFile(filePath, 'utf-8');
    return JSON.parse(data || '[]');
};
 
// ê²Œì‹œê¸€ ë°ì´í„° ì €ì¥
const savePosts = async (posts) => {
    await fs.writeFile(filePath, JSON.stringify(posts, null, 2), 'utf-8');
};

module.exports = { getAllPosts, savePosts };
```

4. [be] postController ì— postWrite ê¸°ëŠ¥ êµ¬í˜„
```javascript
// ê²Œì‹œê¸€ ì‘ì„± ì²˜ë¦¬
const postWrite = async (req, res) => {
    try {
        const userId = req.session.userId;
        const { title, content, postImage} = req.body;
        
        // í•„ìˆ˜ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬
        if (!userId || !title || !content) {
            return res.status(400).json({ message: 'invalid_request', data: null });
        }

        const posts = await getAllPosts();

        // ìƒˆ ê²Œì‹œê¸€ ìƒì„±
        const newPost = {
            postId: posts.length + 1,
            author: userId,
            title,
            content,
            postImage: postImage || null,
            postDate: new Date().toISOString(),
            like: 0,
            view: 0,
            commentsCount: 0,
        };

        posts.push(newPost);
        await savePosts(posts);

        return res.status(201).json({
            message: 'post_created',
            data: { postId: newPost.postId },
        });
    } catch (error) {
        console.error(error);
        return res.status(500).json({ message: 'internal_server_error', data: null });
    }
};
```

5. postman ìœ¼ë¡œ API í™•ì¸í•˜ê¸° <br/>
ì´ë•Œ sessionìœ¼ë¡œ userIdë¥¼ ë°›ì•„ì˜¤ì§€ ëª»í•´ì„œ requireAuth ë¯¸ë“¤ì›¨ì–´ ë¹¼ê³  <br/>
`const userId = req.session.userId;` ëŒ€ì‹  <br/>
`const userId = req.body.userId;` ë¡œ ë°”ê¾¸ê³  ì§„í–‰

6. [fe] post-write.js ì— fetch ì½”ë“œ ìš”ì²­ìœ¼ë¡œ url ë„˜ê²¨ì£¼ê¸°


### ğŸ”¥ ë„ì „ ê³¼ì œ ë‹¬ì„± í™•ì¸, ë‚´ì¼ì˜ ë„ì „ê³¼ì œ ì„¤ì •
- (ì§€ë‚œ) ë„ì „ ê³¼ì œ 1: ì£¼ë§ë™ì•ˆ user, post, comment ë¼ìš°íŠ¸, ì»¨íŠ¸ë¡¤ëŸ¬, ëª¨ë¸ ì½”ë“œ ì™„ì„±í•˜ê¸° ğŸ”º

- (ë‚´ì¼) ë„ì „ ê³¼ì œ 1: ì»¤ë®¤ë‹ˆí‹° comment ê´€ë ¨ ë¼ìš°íŠ¸, ì»¨íŠ¸ë¡¤ëŸ¬, ëª¨ë¸ ì½”ë“œ ì™„ì„±í•˜ê¸°

<br/>

### ğŸ’­ ì˜¤ëŠ˜ì˜ íšŒê³  (ì´ ê³µë¶€ì‹œê°„ 9:09:25)
- ì„±ê³µì ì¸ ì : ë°±ì—”ë“œì—ì„œ API ê´€ë ¨ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  í…ŒìŠ¤íŠ¸ í•˜ëŠ” ì‘ì—… ìˆœì„œê°€ ìµìˆ™í•´ì¡Œë‹¤.
- ê°œì„ í•´ì•¼í•  ì : ë„ì „ ê³¼ì œë¥¼ 'ì™„ì„±'ìœ¼ë¡œ ì„¤ì •í•˜ë‹ˆ ë§¤ì¼ ğŸ”ºë‹¤. <br/>
ì„¸ë¶„í™”í•´ì„œ ì ê³  ì°¨ê·¼ì°¨ê·¼ ê°€ì•¼ê² ë‹¤.
<br/>

### ğŸ“ ì°¸ê³  ìë£Œ ë° ë§í¬
- 